<div class="people-container">
  <!-- Left Navigation Panel -->
  <div class="left-panel">
    <ul class="people-menu">
      <li><a href="#" class="people-nav" data-section="faculty">Faculty</a></li>
      <li><a href="#" class="people-nav" data-section="staff">Staff</a></li>
      <li class="dropdown">
        <a href="#" onclick="return false;">Student</a>
        <ul class="dropdown-menu">
          <li>
            <a href="#" class="people-nav" data-section="students-ug">UG</a>
          </li>
          <li>
            <a href="#" class="people-nav" data-section="students-msc">MSc</a>
          </li>
          <li>
            <a href="#" class="people-nav" data-section="students-mtech"
              >MTech</a
            >
          </li>
          <li>
            <a href="#" class="people-nav" data-section="students-phd">PhD</a>
          </li>
        </ul>
      </li>
      <li class="mobile-dropdown">
        <a href="#" class="dropdown-toggle">Student</a>
        <ul class="mobile-dropdown-menu">
          <li>
            <a href="#" class="people-nav" data-section="students-ug">UG</a>
          </li>
          <li>
            <a href="#" class="people-nav" data-section="students-msc">MSc</a>
          </li>
          <li>
            <a href="#" class="people-nav" data-section="students-mtech"
              >MTech</a
            >
          </li>
          <li>
            <a href="#" class="people-nav" data-section="students-phd">PhD</a>
          </li>
        </ul>
      </li>
      <li><a href="#" class="people-nav" data-section="hods">Ex-HODs</a></li>
      <li><a href="#" class="people-nav" data-section="alumni">Alumni</a></li>
    </ul>
  </div>

  <!-- Right Content Area -->
  <div class="right-content" id="peopleContent">
    <!-- Content loaded dynamically here -->
  </div>
</div>

<button
  class="back-to-top"
  onclick="window.scrollTo({top: 0, behavior: 'smooth'})"
>
  <i class="uil uil-arrow-up"></i>
</button>

<script>
  // Navigation handler for both index and people pages
  function handleNavigation(section) {
    // Update URL without reload
    history.replaceState(null, "", `?section=${section}`);

    // Remove active class from all links
    document
      .querySelectorAll(".people-nav")
      .forEach((link) => link.classList.remove("active"));

    // Add active class to target link
    const activeLink = document.querySelector(
      `.people-nav[data-section="${section}"]`
    );
    if (activeLink) {
      activeLink.classList.add("active");
      // Scroll to active link in left panel
      activeLink.scrollIntoView({ behavior: "smooth", block: "nearest" });
    }

    // Load content
    const contentUrl = `${section}.html`;
    fetch(contentUrl)
      .then((response) => response.text())
      .then((data) => {
        document.getElementById("peopleContent").innerHTML = data;
      });
  }

  // Event listeners for index.html navbar
  document.querySelectorAll(".people-nav").forEach((link) => {
    link.addEventListener("click", function (e) {
      e.preventDefault();
      const section = this.dataset.section;
      // Load people.html first if not already loaded
      if (!document.querySelector(".people-container")) {
        fetch("people.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("dynamicContent").innerHTML = html;
            // Initialize after content loads
            setTimeout(() => handleNavigation(section), 50);
          });
      } else {
        handleNavigation(section);
      }
    });
  });

  // Initialize people page
  if (document.querySelector(".people-container")) {
    let initialSection = "faculty";
    try {
      // Try to get section param from the current script src or document location
      let params;
      if (window.location.search) {
        params = new URLSearchParams(window.location.search);
      } else if (document.currentScript && document.currentScript.src) {
        let urlObj = new URL(document.currentScript.src);
        params = urlObj.searchParams;
      }
      if (!params) {
        // Try to get from parent window if loaded via AJAX
        const match = document.referrer.match(/[?&]section=([^&]+)/);
        if (match) initialSection = decodeURIComponent(match[1]);
      } else {
        initialSection = params.get("section") || "faculty";
      }
    } catch (e) {
      initialSection = "faculty";
    }
    handleNavigation(initialSection);

    // Add event listeners for left panel navigation
    document.querySelectorAll(".people-nav").forEach((link) => {
      link.addEventListener("click", function (e) {
        e.preventDefault();
        handleNavigation(this.dataset.section);
      });
    });
  }

  document.querySelectorAll(".mobile-dropdown > a").forEach((link) => {
    link.addEventListener("touchstart", function (e) {
      e.preventDefault();
      const dropdownMenu = this.nextElementSibling;
      if (dropdownMenu.style.display === "block") {
        dropdownMenu.style.display = "none";
      } else {
        dropdownMenu.style.display = "block";
      }
    });
  });
</script>
<script>
  // Back to top button logic
  window.addEventListener("scroll", () => {
    const btn = document.querySelector(".back-to-top");
    btn.style.display = window.scrollY > 200 ? "flex" : "none";
  });
</script>
